(this["webpackJsonpbus-eta"]=this["webpackJsonpbus-eta"]||[]).push([[0],{96:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(11),i=n.n(s),r=n(67),o=n(19),j=n(142),l=n(147),b=n(149),u=n(146),h=n(55),O=n.n(h),d=n(150),x=n(99),f=n(98),p=n(148),m=n(155),g=n(151),y=n(152),v=n(157),S=n(28),k=n.n(S),w=n(37),C=n(153),_=n(154),B=n(6),I=Object(j.a)({option:{fontSize:15,"& > span":{marginRight:10,fontSize:18}}});function M(e){var t=I(),n=Object(c.useState)([]),s=Object(o.a)(n,2),i=s[0],r=s[1];return Object(c.useEffect)((function(){fetch("https://data.etabus.gov.hk/v1/transport/kmb/stop").then((function(e){return e.json()})).then((function(e){console.log(e),r(e.data)}))}),[]),Object(B.jsx)(_.a,{id:"country-select-demo",onChange:function(t,n){null!==n&&e.changeSelectStop(n.stop)},style:{minWidth:600},options:i,classes:{option:t.option},autoHighlight:!0,getOptionLabel:function(e){return e.name_tc+" "+e.name_en},renderOption:function(e){return Object(B.jsxs)(a.a.Fragment,{children:[e.name_tc," ",e.name_en]})},renderInput:function(e){return Object(B.jsx)(C.a,Object(w.a)(Object(w.a)({},e),{},{label:"Choose a bus stop",variant:"outlined",inputProps:Object(w.a)(Object(w.a)({},e.inputProps),{},{autoComplete:"new-password"})}))}})}var Y=Object(j.a)((function(e){return{title:{flexGrow:2,align:"center"},menuButton:{marginRight:e.spacing(2)},typography:{align:"center"},min:{align:"center"}}}));function N(e){var t=Y(),n=Object(c.useState)([]),a=Object(o.a)(n,2),s=a[0],i=a[1],r=Object(c.useState)(),j=Object(o.a)(r,2),b=j[0],u=j[1],h=Object(c.useState)(),O=Object(o.a)(h,2),d=O[0],m=O[1],g=Object(c.useState)("9583BCF159B682BA"),y=Object(o.a)(g,2),v=y[0],S=y[1],w=Object(c.useState)(1),C=Object(o.a)(w,2),_=C[0],I=C[1],N=Object(c.useState)(1),R=Object(o.a)(N,2),D=(R[0],R[1],"https://data.etabus.gov.hk/v1/transport/kmb/stop-eta/"),H=_>0,A=function(){console.log("fetchKMB"),fetch(D+v).then((function(e){return e.json()})).then((function(t){console.log(t),i(t.data.filter((function(t){return t.eta_seq<=_&&1===t.service_type&&(!!e.isSpecialRoute||!t.rmk_en.includes("route only"))}))),u(t.generated_timestamp),m(k()())}))},q=function(e){var t=k()(e),n=-1*k()().diff(t,"seconds"),c=-1*k()().diff(t,"minutes");return n>60?c+" min":"- min"};return Object(c.useEffect)((function(){A();var e=setInterval((function(){A()}),5e3);return function(){return clearInterval(e)}}),[v,_,e.isSpecialRoute]),Object(B.jsxs)(l.a,{children:[Object(B.jsxs)(l.a,{container:!0,style:{padding:"5px"},children:[Object(B.jsx)(l.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",children:Object(B.jsx)(l.a,{align:"center",style:{flex:2},children:Object(B.jsx)(M,{changeSelectStop:function(e){console.log("url"+D),console.log("change"),S(e)}})})}),Object(B.jsx)(l.a,{style:{flex:1},alignItems:"center",justifyContent:"center",children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(f.a,{onClick:function(){I(_+1)},children:"+"}),H&&Object(B.jsx)(f.a,{disabled:!0,children:_}),H&&Object(B.jsx)(f.a,{onClick:function(){I(_-1)},children:"-"})]})}),Object(B.jsxs)(l.a,{style:{flex:1,align:"center"},children:[Object(B.jsxs)(x.a,{align:"right",children:["Last Update Time: ",k()(b).format("YYYY/MM/DD HH:mm:ss")]}),Object(B.jsxs)(x.a,{align:"right",children:["Last Refresh Time:"," ",k()(d).format("YYYY/MM/DD HH:mm:ss")]})]})]}),Object(B.jsx)(l.a,{direction:"row",justify:"space-between",alignItems:"center",children:s.map((function(e,n){return Object(B.jsxs)(l.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",children:[Object(B.jsx)(l.a,{style:{flex:1},children:1===e.eta_seq&&Object(B.jsx)(x.a,{align:"center",variant:"h3",children:e.route})}),Object(B.jsx)(l.a,{style:{flex:4},children:1===e.eta_seq&&Object(B.jsxs)(x.a,{align:"center",variant:"h5",className:t.typography,children:[Object(B.jsx)(x.a,{variant:"h5",className:t.typography,children:e.dest_tc}),Object(B.jsx)(x.a,{variant:"h6",className:t.typography,children:e.dest_en})]})}),Object(B.jsx)(l.a,{style:{flex:1},children:Object(B.jsxs)(x.a,{align:"center",className:t.min,children:[Object(B.jsx)(x.a,{variant:"h4",children:q(e.eta)}),Object(B.jsx)(x.a,{variant:"h6",children:e.rmk_tc})]})}),Object(B.jsx)("img",{src:"https://na.cx/i/cMDkd52.jpg",className:"photo",alt:"KMB",width:"100px",height:"100px"})]})}))})]})}var R=Object(j.a)((function(e){return{BusStop:{flexGrow:2,align:"center"}}}));function D(){var e=R(),t=Object(c.useState)(1),n=Object(o.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(!1),j=Object(o.a)(i,2),h=j[0],S=j[1],k=Object(c.useState)(!1),w=Object(o.a)(k,2),C=w[0],_=w[1],I=a>0;return Object(B.jsxs)(l.a,{children:[Object(B.jsx)(b.a,{color:"secondary",children:Object(B.jsxs)(d.a,{children:[Object(B.jsx)(u.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",onClick:function(){S(!0)},children:Object(B.jsx)(O.a,{})}),Object(B.jsx)(x.a,{variant:"h6",className:e.title,children:"Bus Arrival Time"})]})}),Object(B.jsx)(d.a,{}),Object(B.jsx)(l.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"baseline",children:Object(r.a)(Array(a)).map((function(e,t){return Object(B.jsx)(l.a,{style:{flex:1},children:Object(B.jsx)(N,{isSpecialRoute:C})})}))}),Object(B.jsxs)(m.a,{open:h,children:[Object(B.jsx)(f.a,{onClick:function(){S(!1)},children:"Close"}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(f.a,{onClick:function(){s(a+1)},children:"+"}),I&&Object(B.jsx)(f.a,{disabled:!0,children:a}),I&&Object(B.jsx)(f.a,{onClick:function(){s(a-1)},children:"-"})]}),Object(B.jsxs)(g.a,{column:!0,children:[Object(B.jsx)(y.a,{control:Object(B.jsx)(v.a,{checked:C,onChange:function(e){_(e.target.checked)},name:"checkedA"}),label:"\u7279\u5225\u8def\u7dda"}),Object(B.jsx)(y.a,{control:Object(B.jsx)(v.a,{checked:!0,onChange:"",name:"checkedB",color:"primary"}),label:"Primary"})]})]})]})}var H=document.getElementById("root");i.a.render(Object(B.jsx)(c.StrictMode,{children:Object(B.jsx)(D,{})}),H)}},[[96,1,2]]]);
//# sourceMappingURL=main.da98b7b9.chunk.js.map